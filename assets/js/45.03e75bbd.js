(window.webpackJsonp=window.webpackJsonp||[]).push([[45],{389:function(t,s){t.exports="data:image/png;base64,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"},390:function(t,s,a){t.exports=a.p+"assets/img/6.7291244b.png"},391:function(t,s,a){t.exports=a.p+"assets/img/7.2a4864b1.png"},879:function(t,s,a){"use strict";a.r(s);var n=a(28),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[n("p",[t._v("指令的职责是，当表达式的值改变时，将其产生的连带影响响应式地作用于DOM。")]),t._v(" "),n("p",[t._v("在模板解析阶段将节点上的指令解析出来并添加到AST的directives属性中，directives数据会传递到VNode中，我们就可以通过vnode.data.directives获取一个节点所绑定的指令。当虚拟DOM进行修补时，会根据节点的对比结果触发一些钩子函数。更新指令的程序会监听create、update和destroy钩子函数，并在这三个钩子函数触发时对VNode和oldVNode进行对比，最终根据对比结果触发指令的钩子函数。（使用自定义指令时，可以监听5种钩子函数：bind、inserted、update、componentUpdated与unbind。）指令的钩子函数被触发后，就说明指令生效了。\n"),n("img",{attrs:{src:a(389),alt:""}})]),t._v(" "),n("h3",{attrs:{id:"v-if指令的原理概述"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#v-if指令的原理概述"}},[t._v("#")]),t._v(" v-if指令的原理概述")]),t._v(" "),n("p",[t._v("模板代码")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("li v"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"has"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("li"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("li v"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("li"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n")])])]),n("p",[t._v("生成的代码字符串")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("has"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("_c")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'li'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("_v")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"if"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("_c")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'li'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("_v")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"else"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),n("p",[t._v("上面的代码会根据has变量的值来选择创建哪个节点")]),t._v(" "),n("h3",{attrs:{id:"v-for指令的原理概述"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#v-for指令的原理概述"}},[t._v("#")]),t._v(" v-for指令的原理概述")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("li v"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"(item, index) in list"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("v"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("index"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("li"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n")])])]),n("p",[t._v("生成的代码字符串（格式化后的）")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[t._v("_l")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("list"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("item"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" index")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("_c")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'li'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("_v")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"v-for "')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("_s")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("index"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),n("p",[t._v("_l是函数renderList的别名。当执行这段代码字符串时，_l函数会循环变量list并依次调用第二个参数所传递的函数。同时，会传递两个参数：item和index。此外，当 _c函数被调用时，会执行 _v函数创建一个文本节点。")]),t._v(" "),n("h3",{attrs:{id:"v-on指令"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#v-on指令"}},[t._v("#")]),t._v(" v-on指令")]),t._v(" "),n("p",[t._v("v-on指令的作用是绑定事件监听器。这里我们介绍v-on用在普通元素上，内部如何监听DOM事件。")]),t._v(" "),n("p",[t._v("从模板解析到生成VNode，最终事件会被保存在VNode中，然后可以通过vnode.data.on得到一个节点注册的所有事件。")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("button v"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("on"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("click"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"doThat"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("我是按钮"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("button"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n")])])]),n("p",[t._v("通过vnode.data.on读出的事件对象")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("click")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("p",[t._v("事件绑定的相关逻辑分别设置了create和update钩子函数，当一个DOM元素被创建或更新时，都会触发事件绑定逻辑的处理。")]),t._v(" "),n("p",[t._v("事件绑定相关的处理逻辑是updateDOMListeners函数：")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" target\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("updateDOMListeners")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("oldVnode"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" vnode")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 两个VNode中的事件对象都不存在，说明上一次没有绑定任何事件，这一次元素更新也没有新增事件绑定，因此并不需要进行事件的绑定与解绑，直接使用return语句终止函数")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("isUndef")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("oldVnode"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("data"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("on"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("isUndef")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("vnode"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("data"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("on"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 新虚拟节点上的事件对象")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" on "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" vnode"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("data"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("on "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("||")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 旧虚拟节点上的事件对象")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" oldOn "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" oldVnode"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("data"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("on "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("||")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// vnode.elm保存vnode所对应的DOM元素")]),t._v("\n  target "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" vnode"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("elm\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 对特殊情况下的事件对象做一些特殊处理")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("normalizeEvents")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("on"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 更新事件监听器，对比on与oldOn，然后根据对比结果调用add方法或remove方法执行对应的绑定事件或解绑事件等")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("updateListeners")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("on"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" oldOn"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" add"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" remove"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" vnode"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("context"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  target "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("undefined")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("p",[t._v("add和remove方法是如何绑定与解绑DOM原生事件的呢")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("add")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("event"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" handler"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" once"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" capture"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" passive")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// withMacroTask函数的作用是给回调函数做一层包装，当事件触发时，如果因为回调中修改了数据而触发更新DOM的操作，那么该更新操作会被推送到宏任务（macrotask）的任务队列中")]),t._v("\n  handler "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("withMacroTask")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("handler"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 如果v-on使用了once修饰符，那么会使用高阶函数createOnceHandler实现once的功能")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("once"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" handler "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("createOnceHandler")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("handler"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" event"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" capture"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 将指定的监听器注册到target上，而target就是使用了v-on的DOM元素")]),t._v("\n  target"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("addEventListener")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    event"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    handler"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    supportsPassive\n      "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" capture"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" passive "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" capture\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 解绑事件")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("remove")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("event"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" handler"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" capture"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" _target")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("_target "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("||")]),t._v(" target"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("removeEventListener")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    event"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// handler._withTask存在，则解绑handler. _withTask。这是因为在绑定事件时经过了withMacroTask的处理，最终被绑定的事件监听器其实是handler._withTask，所以解绑时也需要解绑handler._withTask，只有handler. _withTask不存在时才解绑handler")]),t._v("\n    handler"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("_withTask "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("||")]),t._v(" handler"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    capture\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("createOnceHandler")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("handler"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" event"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" capture")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" _target "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" target "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 在闭包中保存当前目标元素")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("onceHandler")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" res "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("handler")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("apply")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" arguments"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 函数的返回值不是null的时候解绑")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("res "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!==")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 执行remove函数来解绑事件，使事件只能被执行一次")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("remove")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("event"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" onceHandler"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" capture"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" _target"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("p",[t._v("v-on指令实现的简单过程：\n"),n("img",{attrs:{src:a(390),alt:"v-on指令的简单过程"}})]),t._v(" "),n("h2",{attrs:{id:"自定义指令的内部原理"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#自定义指令的内部原理"}},[t._v("#")]),t._v(" 自定义指令的内部原理")]),t._v(" "),n("p",[t._v("虚拟DOM在渲染时，除了更新DOM内容外，还会触发钩子函数。事件、指令、属性等相关处理逻辑只需要监听钩子函数，在钩子函数触发时执行相关处理逻辑即可实现功能。")]),t._v(" "),n("p",[t._v("指令的处理逻辑分别监听了create、update与destroy")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  create"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" updateDirectives"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  update"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" updateDirectives"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("destroy")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("unbindDirectives")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("vnode")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("updateDirectives")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("vnode"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" emptyNode"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("p",[t._v("虚拟DOM在触发钩子函数时，上面代码中对应的函数会被执行且都会执行updateDirectives方法。")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("updateDirectives")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("oldVnode"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" vnode")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 只要其中有一个虚拟节点存在directives，那么就执行_update函数处理指令，在模板解析时，directives会从模板的属性中解析出来并最终设置到VNode中。")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("oldVnode"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("data"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("directives "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("||")]),t._v(" vnode"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("data"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("directives"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("_update")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("oldVnode"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" vnode"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("_update")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("oldVnode"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" vnode")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 判断虚拟节点是否是一个新创建的节点")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" isCreate "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" oldVnode "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" emptyNode\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 当新虚拟节点不存在而旧虚拟节点存在时为真")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" isDestroy "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" vnode "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" emptyNode\n\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 旧的指令集合，指oldVnode中保存的指令")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// normalizeDirectives函数将模板中使用的指令从用户注册的自定义指令集合中取出来")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" oldDirs "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("normalizeDirectives")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("oldVnode"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("data"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("directives"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" oldVnode"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("context"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 新的指令集合，指vnode中保存的指令")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" newDirs "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("normalizeDirectives")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("vnode"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("data"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("directives"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" vnode"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("context"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 保存需要触发inserted指令钩子函数的指令列表")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" dirsWithInsert "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 保存需要触发componentUpdated钩子函数的指令列表")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" dirsWithPostpatch "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" key"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" oldDir"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" dir\n\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 对比两个指令集合并触发对应的指令钩子函数")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("key "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" newDirs"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 从oldDirs取出指令保存到oldDir中")]),t._v("\n    oldDir "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" oldDirs"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("key"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 从newDirs取出指令保存到dir中")]),t._v("\n    dir "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" newDirs"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("key"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// oldDir如果不存在，说明当前循环到的指令是首次绑定到元素")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("oldDir"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 新指令，触发bind，callHook的作用是找出指令中对应钩子函数名称的方法，如果该方法存在，则执行它")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("callHook")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("dir"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'bind'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" vnode"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" oldVnode"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 如果该指令在注册时设置了inserted方法，那么将指令添加到dirsWithInsert中，可以保证执行完所有指令的bind方法后再执行指令的inserted方法")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("dir"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("def "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" dir"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("def"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("inserted"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        dirsWithInsert"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("push")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("dir"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// oldDir存在说明指令之前绑定过了，这次的操作是更新指令")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 在dir上添加oldValue属性并在其中保存上一次指令的value属性值")]),t._v("\n      dir"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("oldValue "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" oldDir"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("value\n\n      "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("callHook")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("dir"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'update'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" vnode"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" oldVnode"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 判断注册自定义指令时，该指令是否设置了componentUpdated方法。如果设置了，则将该指令添加到dirsWithPostpatch列表中。这样做的目的是让指令所在组件的VNode及其子VNode全部更新后，再调用指令的componentUpdated方法。")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("dir"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("def "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" dir"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("def"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("componentUpdated"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        dirsWithPostpatch"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("push")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("dir"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 判断dirsWithInsert列表中是否有元素")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("dirsWithInsert"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("length"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("callInsert")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 则循环dirsWithInsert依次调用callHook执行每一个指令的inserted钩子函数")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" i "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" dirsWithInsert"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("length"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("callHook")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("dirsWithInsert"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("i"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'inserted'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" vnode"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" oldVnode"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 判断虚拟节点是否为一个新创建的节点，如果是，等到元素被插入到父节点之后再执行指令的inserted方法。")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("isCreate"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// mergeVNodeHook可以将一个钩子函数与虚拟节点现有的钩子函数合并在一起，这样当虚拟DOM触发钩子函数时，新增的钩子函数也会被执行。这里将callInsert添加到虚拟节点的insert钩子函数列表中，这样可以将钩子函数的执行推迟到被绑定的元素插入到父节点之后进行。")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("mergeVNodeHook")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("vnode"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'insert'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" callInsert"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 如果isCreate不为真，那么不需要将执行指令的操作推迟到元素被插入到父节点之后，直接执行callInsert执行指令的inserted方法即可。")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 这个函数执行时，才会循环dirsWithInsert依次调用每一个指令的inserted钩子函数，这样做其实是为了让指令的inserted方法在被绑定元素插入到父节点后再调用。")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("callInsert")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("dirsWithPostpatch"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("length"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  \n    "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("mergeVNodeHook")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("vnode"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'postpatch'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" i "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" dirsWithPostpatch"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("length"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("callHook")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("dirsWithPostpatch"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("i"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'componentUpdated'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" vnode"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" oldVnode"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 判断当前虚拟节点是否为新创建的")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("isCreate"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 循环旧的指令列表oldDirs")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("key "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" oldDirs"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 查看它在newDirs中是否存在")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("newDirs"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("key"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 不存在则说明这个指令在旧虚拟节点的指令列表中存在，但在新虚拟节点的指令列表中不存在，此时调用callHook执行指令的unbind方法即可")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("callHook")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("oldDirs"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("key"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'unbind'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" oldVnode"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" oldVnode"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" isDestroy"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* \ndir：指令对象。\nhook：将要触发的钩子函数名。\nvnode：新虚拟节点。\noldVnode：旧虚拟节点。\nisDestroy：当新虚拟节点不存在而旧虚拟节点存在时为真。\n*/")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("callHook")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("dir"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" hook"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" vnode"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" oldVnode"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" isDestroy")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 取出对应的钩子函数")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" fn "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" dir"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("def "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" dir"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("def"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("hook"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 判断钩子函数是否存在")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("fn"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 使用try...catch语句捕获钩子函数在执行时可能会抛出的错误")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("try")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("fn")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("vnode"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("elm"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" dir"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" vnode"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" oldVnode"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" isDestroy"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("catch")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("e"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 处理错误逻辑")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("handleError")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("e"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" vnode"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("context"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token template-string"}},[n("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("directive ")]),n("span",{pre:!0,attrs:{class:"token interpolation"}},[n("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),t._v("dir"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name"),n("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v(" ")]),n("span",{pre:!0,attrs:{class:"token interpolation"}},[n("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),t._v("hook"),n("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v(" hook")]),n("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("p",[t._v("这里说下_update函数中的normalizeDirectives函数将模板中使用的指令从用户注册的自定义指令集合中取出来")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  v"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("focus"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    def"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("inserted"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    modifiers"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    name"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"focus"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    rawName"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"v-focus"')]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("p",[t._v("自定义指令的代码为")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[t._v("Vue"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("directive")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'focus'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("inserted")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("el")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    el"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("focus")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),n("p",[t._v("自定义指令简要过程：\n"),n("img",{attrs:{src:a(391),alt:""}})]),t._v(" "),n("h2",{attrs:{id:"虚拟dom钩子函数"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#虚拟dom钩子函数"}},[t._v("#")]),t._v(" 虚拟DOM钩子函数")]),t._v(" "),n("p",[t._v("虚拟DOM在渲染时会触发的所有钩子函数及其触发时机")]),t._v(" "),n("table",[n("thead",[n("tr",[n("th",[t._v("名称")]),t._v(" "),n("th",{staticStyle:{"text-align":"center"}},[t._v("触发时机")]),t._v(" "),n("th",{staticStyle:{"text-align":"right"}},[t._v("回调参数")])])]),t._v(" "),n("tbody",[n("tr",[n("td",[t._v("init")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("已添加vnode，在修补期间发现新的虚拟节点时被触发")]),t._v(" "),n("td",{staticStyle:{"text-align":"right"}},[t._v("vnode")])]),t._v(" "),n("tr",[n("td",[t._v("create")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("已经基于VNode创建了DOM元素")]),t._v(" "),n("td",{staticStyle:{"text-align":"right"}},[t._v("emptyNode和vnode")])]),t._v(" "),n("tr",[n("td",[t._v("activate")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("keepAlive组件被创建")]),t._v(" "),n("td",{staticStyle:{"text-align":"right"}},[t._v("emptyNode和innerNode")])]),t._v(" "),n("tr",[n("td",[t._v("insert")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("一旦vnode对应的DOM元素被插入到视图中并且修补周期的其余部分已经完成，就会触发")]),t._v(" "),n("td",{staticStyle:{"text-align":"right"}},[t._v("vnode")])]),t._v(" "),n("tr",[n("td",[t._v("prepatch")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("一个元素即将被修补")]),t._v(" "),n("td",{staticStyle:{"text-align":"right"}},[t._v("oldVnode和vnode")])]),t._v(" "),n("tr",[n("td",[t._v("update")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("一个元素正在被更新")]),t._v(" "),n("td",{staticStyle:{"text-align":"right"}},[t._v("oldVnode和vnode")])]),t._v(" "),n("tr",[n("td",[t._v("postpatch")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("一个元素已经被修补")]),t._v(" "),n("td",{staticStyle:{"text-align":"right"}},[t._v("oldVnode和vnode")])]),t._v(" "),n("tr",[n("td",[t._v("destroy")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("它的DOM元素从DOM中移除时或者它的父元素从DOM中移除时触发")]),t._v(" "),n("td",{staticStyle:{"text-align":"right"}},[t._v("vnode")])]),t._v(" "),n("tr",[n("td",[t._v("remove")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("vnode对应的DOM元素从DOM中被移除时触发此钩子函数。需要说明的是，只有一个元素从父元素中被移除时会触发，但是如果它是被移除的元素的子项，则不会触发")]),t._v(" "),n("td",{staticStyle:{"text-align":"right"}},[t._v("vnode和removeCallback")])])])])])}),[],!1,null,null,null);s.default=e.exports}}]);